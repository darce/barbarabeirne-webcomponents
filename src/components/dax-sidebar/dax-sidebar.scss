@use '../../styles/shared' as *;

// Component-specific variables
$sidebar-bg: $color-translucent-white-50;
$sidebar-mobile-width: min(80vw, 320px);
$sidebar-z-index: $z-index-modal;
$sidebar-z-index-desktop: 9999;
$sidebar-masthead-font-size: $font-size-subheader;
$sidebar-masthead-font-weight: $font-weight-medium;
$sidebar-masthead-link-padding-vertical: 20px;
$sidebar-masthead-link-padding-horizontal: 20px;
$sidebar-toggle-padding: $spacing-sm;
$sidebar-toggle-icon-size: $font-size-xl;
$sidebar-toggle-icon-weight: 400;
$sidebar-focus-ring-offset-outset: 2px;

// Host styles
:host {
  display: block;
  --dax-sidebar-breakpoint-nav: #{$breakpoint-nav};
}

// Backdrop for mobile
.dax-sidebar-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: $color-translucent-black;
  z-index: $sidebar-z-index - 1;
  opacity: 0;
  transition: opacity $duration-normal $ease-out;
}

// Only show backdrop on mobile when menu is open
@media (max-width: $breakpoint-nav) {
  :host([data-nav-open="true"]) .dax-sidebar-backdrop {
    display: block;
    opacity: 1;
  }
}

// Sidebar container (the <aside>)
.dax-sidebar {
  position: fixed;
  top: 0;
  left: 0;
  z-index: $sidebar-z-index;
  width: $dax-sidebar-width;
}

:host([data-nav-open="false"]) .dax-sidebar {
  pointer-events: none;
}

:host([data-nav-open="false"]) .dax-sidebar-header {
  pointer-events: auto;
}

// Masthead container (stays visible when nav is collapsed)
.dax-sidebar-header {
  background: $color-white;
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: 10;
  height: $dax-sidebar-masthead-height;
}

.dax-sidebar-masthead {
  display: flex;
  align-items: center;
  gap: $spacing-sm;
  padding-left: $spacing-sm;
  width: 100%;
  height: 100%;
}

// Masthead styling
.masthead {
  text-transform: uppercase;
  text-align: center;
  font-weight: $sidebar-masthead-font-weight;
  font-size: $sidebar-masthead-font-size;
  padding: 0;
  margin: 0;
  flex: 1;

  a {
    display: block;
    padding: $sidebar-masthead-link-padding-vertical $sidebar-masthead-link-padding-horizontal $sidebar-masthead-link-padding-vertical 0;
    color: $color-black;
    text-decoration: none;

    &:hover {
      background: $color-gray;
      color: $color-white;
    }

    &:focus,
    &:focus-visible {
      outline: $focus-ring-width solid $color-black;
      outline-offset: $focus-ring-offset;
    }
  }
}

// Toggle button styling
.dax-sidebar-toggle {
  background: $sidebar-bg;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  border: none;
  cursor: pointer;
  padding: $sidebar-toggle-padding;
  color: $color-black;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;

  &:hover {
    background: $color-gray;
    color: $color-white;
  }

  &:focus,
  &:focus-visible {
    outline: $focus-ring-width solid $color-black;
    outline-offset: $sidebar-focus-ring-offset-outset;
  }

  .material-symbols-sharp {
    font-size: $sidebar-toggle-icon-size;
    font-family: $font-family-icons;
    font-weight: $sidebar-toggle-icon-weight;
    font-style: normal;
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 48;
    display: inline-block;
    line-height: 1;
    transition: transform $duration-fast $ease-out;
  }
}

// Rotate icon when menu is open
:host([data-nav-open="true"]) .dax-sidebar-toggle .material-symbols-sharp {
  transform: rotate(90deg);
}

// Mobile specific adjustments
@media (max-width: $breakpoint-nav) {
  .dax-sidebar {
    width: $sidebar-mobile-width;
    padding-top: $dax-sidebar-masthead-height;
  }

  .dax-sidebar-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    z-index: $sidebar-z-index;
  }

  .dax-sidebar-masthead {
    width: 100%;
    padding-right: $spacing-sm;
  }

  .masthead {
    text-align: right;
  }
}

// Desktop specific adjustments
@media (min-width: $breakpoint-gallery-intro) {
  .dax-sidebar {
    // Increase z-index to ensure it sits above everything
    z-index: $sidebar-z-index-desktop;
  }
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {

  .dax-sidebar-toggle .material-symbols-sharp,
  .dax-sidebar-backdrop {
    transition: none;
  }
}
