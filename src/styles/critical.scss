// ============================================================================
// Critical FOUC Prevention Styles
// ============================================================================
// These minimal styles ensure components render correctly BEFORE JavaScript
// runs. They target raw HTML structure that JS will later enhance.
//
// This file is compiled first and concatenated with component CSS.
// ============================================================================

@use 'variables' as *;

// -----------------------------------------------------------------------------
// dax-sidebar: Position the Shadow DOM host element
// -----------------------------------------------------------------------------
// The shadow DOM handles all internal styling including translucency.
// We only need to position the host element in the document flow.
dax-sidebar {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    z-index: $z-index-modal;
    width: $dax-sidebar-width;
}

// -----------------------------------------------------------------------------
// dax-carousel: Style raw markup to match final component appearance
// -----------------------------------------------------------------------------
// Before JS runs, the carousel contains a raw <ul><li> structure.
// JS adds .dax-slides and .dax-slide classes. We style the raw structure
// to match the final appearance and prevent a flash of unstyled content.

// Container baseline (matches dax-carousel.scss)
dax-carousel {
    display: block;
    position: relative;
    width: 100%;
    height: 100%;
    background-color: $color-black;
}

// Fullscreen mode: match the .fullscreen class that JS adds in connectedCallback
// On initial load, the attribute exists but the class hasn't been added yet.
// Without this, the carousel has height:100% but <main> has no height,
// so the carousel collapses to intrinsic image size until JS runs.
dax-carousel[fullscreen] {
    position: fixed;
    inset: 0;
    z-index: $z-index-base;

    > ul:not(.dax-slides) > li:first-child {
        img,
        picture {
            display: block;
            object-fit: cover;
            height: 100vh;
            max-height: none;
            width: 100vw;
        }
    }
}

// Hide undefined custom element completely until JS registers it
// This is the nuclear option - prevents any FOUC at cost of showing nothing
// dax-carousel:not(:defined) {
//     visibility: hidden;
// }

dax-carousel {
    // Style raw list the same as .dax-slides
    > ul:not(.dax-slides) {
        position: absolute;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        list-style: none;

        // Style raw items the same as .dax-slide
        > li {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;

            // Show only the first slide initially
            &:first-child {
                opacity: 1;
                visibility: visible;
            }

            // Match figure sizing from dax-carousel.scss
            figure {
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: center;
                width: 100%;
                height: 100%;
            }

            // <picture> must be transparent so img height resolves from figure
            picture {
                display: contents;
            }

            // Match img sizing from dax-carousel.scss (desktop base)
            img {
                width: auto;
                max-width: 100%;
                height: 100%;
                max-height: 100%;
                object-fit: contain;
            }

            // Hide figcaption until JS can properly position and style it
            figcaption {
                opacity: 0;
                visibility: hidden;
            }
        }
    }
}

// Mobile overrides for raw markup (matches dax-carousel.scss mobile block)
@media (max-width: $breakpoint-nav) {
    dax-carousel > ul:not(.dax-slides) > li {
        display: flex;
        flex-direction: column;

        figure {
            flex: 1;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }

        img {
            flex-shrink: 1;
            min-height: 0;
            width: 100%;
            max-width: 100%;
            height: auto;
            max-height: 60%;
        }
    }
}
